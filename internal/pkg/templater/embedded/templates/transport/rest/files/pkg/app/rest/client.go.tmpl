package rest

import (
	"context"
	"net/http"

	"github.com/prometheus/client_golang/prometheus"

	rtrest "github.com/Educentr/go-project-starter-runtime/pkg/app/rest"
	"github.com/Educentr/go-project-starter-runtime/pkg/ds"
)

// Middleware is a type alias for backward compatibility.
// The canonical definition is in the runtime package.
type Middleware = rtrest.Middleware

// RoundTripper is a type alias for backward compatibility.
type RoundTripper = rtrest.RoundTripper

// DefaultClient is a type alias for backward compatibility.
type DefaultClient = rtrest.DefaultClient

// Chain delegates to the runtime implementation.
func Chain(rt http.RoundTripper, middlewares ...Middleware) http.RoundTripper {
	return rtrest.Chain(rt, middlewares...)
}

// RoundTripperFunc delegates to the runtime implementation.
func RoundTripperFunc(f func(req *http.Request) (*http.Response, error)) RoundTripper {
	return rtrest.RoundTripperFunc(f)
}

// GetClientMiddlewares is a package-level convenience that delegates to DefaultClient.
func GetClientMiddlewares(ctx context.Context, appName string, metrics *prometheus.Registry, srv ds.IService, serviceName string, errHdl rtrest.RestErrorHandler) []Middleware {
	c := &DefaultClient{}
	return c.GetClientMiddlewares(ctx, appName, metrics, srv, serviceName, errHdl)
}
