# This file is generated by go-project-starter.
# nfpm configuration for {{ .ProjectName }}-{{ .Application.Name }}
# https://nfpm.goreleaser.com/configuration/

name: "{{ .ProjectName }}-{{ .Application.Name }}"
arch: "amd64"
platform: "linux"
version: "${VERSION:-0.0.1}"
maintainer: "{{ .Artifacts.Packaging.Maintainer }}"
description: "{{ .Artifacts.Packaging.Description }}"
{{- if .Artifacts.Packaging.Homepage }}
homepage: "{{ .Artifacts.Packaging.Homepage }}"
{{- end }}
{{- if .Artifacts.Packaging.License }}
license: "{{ .Artifacts.Packaging.License }}"
{{- end }}
{{- if .Artifacts.Packaging.Vendor }}
vendor: "{{ .Artifacts.Packaging.Vendor }}"
{{- end }}

contents:
  # Binary
  - src: ./bin/{{ .Application.Name }}
    dst: {{ .Artifacts.Packaging.InstallDir }}/{{ .Application.Name }}
    file_info:
      mode: 0755

  # Systemd service file
  - src: ./packaging/{{ .Application.Name }}/systemd/{{ .ProjectName }}-{{ .Application.Name }}.service
    dst: /lib/systemd/system/{{ .ProjectName }}-{{ .Application.Name }}.service
    file_info:
      mode: 0644

  # Config directory (empty)
  - dst: {{ .Artifacts.Packaging.ConfigDir }}/{{ .Application.Name }}
    type: dir
    file_info:
      mode: 0755

scripts:
  postinstall: ./packaging/{{ .Application.Name }}/scripts/postinstall.sh
  preremove: ./packaging/{{ .Application.Name }}/scripts/preremove.sh
